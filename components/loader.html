<!-- Loading Component -->
<div id="pageLoader" class="fixed inset-0 bg-white dark:bg-gray-900 z-[9999] flex items-center justify-center transition-opacity duration-500">
    <div class="text-center">
        <!-- Logo animado -->
        <div class="mb-8">
            <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 animate-pulse">
                <span class="text-white font-bold text-2xl">IA</span>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">IA Insight</h2>
            <p class="text-gray-600 dark:text-gray-400">Carregando experiência inteligente...</p>
        </div>
        
        <!-- Loading spinner avançado -->
        <div class="relative">
            <div class="w-16 h-16 border-4 border-gray-200 dark:border-gray-700 rounded-full animate-spin">
                <div class="absolute top-0 left-0 w-full h-full border-4 border-transparent border-t-green-500 rounded-full animate-spin"></div>
                <div class="absolute top-0 left-0 w-full h-full border-4 border-transparent border-r-blue-500 rounded-full animate-spin" style="animation-delay: -0.5s;"></div>
            </div>
        </div>
        
        <!-- Progress dots -->
        <div class="flex justify-center mt-6 space-x-2">
            <div class="w-2 h-2 bg-green-500 rounded-full animate-bounce" style="animation-delay: 0s;"></div>
            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s;"></div>
            <div class="w-2 h-2 bg-purple-500 rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
        </div>
        
        <!-- Loading text animado -->
        <div class="mt-4">
            <p class="text-sm text-gray-500 dark:text-gray-400 typing-animation">
                Preparando agentes de IA...
            </p>
        </div>
    </div>
    
    <!-- Partículas de fundo -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-1/4 left-1/4 w-2 h-2 bg-green-400 rounded-full opacity-20 animate-float" style="animation-delay: 0s;"></div>
        <div class="absolute top-1/3 right-1/4 w-3 h-3 bg-blue-400 rounded-full opacity-20 animate-float" style="animation-delay: 1s;"></div>
        <div class="absolute bottom-1/4 left-1/3 w-2 h-2 bg-purple-400 rounded-full opacity-20 animate-float" style="animation-delay: 2s;"></div>
        <div class="absolute top-1/2 right-1/3 w-1 h-1 bg-green-400 rounded-full opacity-20 animate-float" style="animation-delay: 3s;"></div>
        <div class="absolute bottom-1/3 right-1/4 w-2 h-2 bg-blue-400 rounded-full opacity-20 animate-float" style="animation-delay: 4s;"></div>
    </div>
</div>

<style>
/* Animações específicas do loader */
@keyframes float {
    0%, 100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.2;
    }
    50% {
        transform: translateY(-20px) rotate(180deg);
        opacity: 0.6;
    }
}

.animate-float {
    animation: float 3s ease-in-out infinite;
}

/* Typing animation para o texto */
.typing-animation {
    overflow: hidden;
    border-right: 2px solid #10b981;
    white-space: nowrap;
    animation: typing 3s steps(40, end), blink-caret 0.75s step-end infinite;
}

@keyframes typing {
    from { width: 0; }
    to { width: 100%; }
}

@keyframes blink-caret {
    from, to { border-color: transparent; }
    50% { border-color: #10b981; }
}

/* Spinner customizado */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

/* Bounce animation */
@keyframes bounce {
    0%, 20%, 53%, 80%, 100% {
        transform: translate3d(0,0,0);
    }
    40%, 43% {
        transform: translate3d(0, -30px, 0);
    }
    70% {
        transform: translate3d(0, -15px, 0);
    }
    90% {
        transform: translate3d(0, -4px, 0);
    }
}

.animate-bounce {
    animation: bounce 1s infinite;
}
</style>

<script>
// Controle do loader
document.addEventListener('DOMContentLoaded', function() {
    const loader = document.getElementById('pageLoader');
    
    // Simular tempo de carregamento mínimo
    setTimeout(() => {
        if (loader) {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
                // Inicializar componentes após o loader
                if (typeof initializeComponents === 'function') {
                    initializeComponents();
                }
            }, 500);
        }
    }, 2000); // Tempo mínimo de 2 segundos
    
    // Fallback: esconder loader se demorar muito
    setTimeout(() => {
        if (loader && loader.style.display !== 'none') {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        }
    }, 5000); // Máximo de 5 segundos
});

// Mostrar loader em transições de página
window.addEventListener('beforeunload', function() {
    const loader = document.getElementById('pageLoader');
    if (loader) {
        loader.style.display = 'flex';
        loader.style.opacity = '1';
    }
});
</script>
